<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<HTML>
<HEAD>
   <TITLE>Problems Statement: CERC 2000</TITLE>
   <META NAME="Description" CONTENT="ACM International Collegiate
         Central Europe 2000 Contest, problem set statement.">
   <META NAME="Keywords" CONTENT="ACM, Programming Contest, CERC 2000">
   <META NAME="Author" CONTENT="Michal Sevcenko">
   <META NAME="Generator" CONTENT="hand made">
</HEAD>
<BODY BGCOLOR="White">

<!-- ***** klikaci mapy ***** -->

<!-- linka s mailem -->
<MAP NAME="map-mail">
   <AREA SHAPE="Circle" COORDS="471,15,16" ALT="e-mail"
   HREF="mailto:cinfo@contest.felk.cvut.cz">
   <AREA SHAPE="Rect" COORDS="471,20, 510,31" ALT="e-mail"
   HREF="mailto:cinfo@contest.felk.cvut.cz">
   
   <AREA SHAPE="Circle" COORDS="535,15,16" ALT="how to use these pages?"
   HREF="../help.html">
   <AREA SHAPE="Rect" COORDS="535,20, 578,31" ALT="how to use these pages?"
   HREF="../help.html">
</MAP>


<!-- ***** zahlavi s logem souteze ***** -->

<CENTER>
<P><TABLE BORDER=0><TR><TD>
<IMG SRC="../../img/counter.gif" ALT="ACM" WIDTH=128 HEIGHT=96>
<TD><IMG SRC="../../img/contest.gif" ALT="Programming Contest"
width=424 height=96></TABLE>

<IMG SRC="../../img/line-mail.gif" WIDTH=592 HEIGHT=32 ALT="e-mail"
BORDER=0 USEMAP="#map-mail">


<P><TABLE WIDTH=600 BORDER=0 CELLSPACING=0 CELLPADDING=0>
<TR><TD>

<P ALIGN="Center"><B>ACM International Collegiate Programming Contest</B>
<BR>Sponsored by IBM
<P ALIGN="Center"><B>Central Europe 2000 Regional Contest</B>
<P>
<P ALIGN="Center">Czech Technical University in Prague
<BR>Dept. of Computer Science, Faculty of Electrical Engineering
<BR>
<P ALIGN="Center">November 11, 2000
<BR>&nbsp;<BR>&nbsp;<BR>


<P><IMG SRC="../../img/line.gif" WIDTH=592 HEIGHT=32 BORDER=0>

<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

<TABLE ALIGN=CENTER>

<TR><TD><IMG
ALT="[" SRC="poc-left.gif"><IMG ALT="-" SRC="poc-empty.gif"><IMG ALT="a" SRC="a.gif"><IMG ALT="-" SRC="poc-empty.gif"><IMG ALT="]" SRC="poc-right.gif"></TD>
<TD>&nbsp;&nbsp;&nbsp;</TD>
<TD><A HREF="#arith">Simple Arithmetics</A></TD></TR>

<TR><TD><IMG
ALT="[" SRC="poc-left.gif"><IMG ALT="-" SRC="poc-empty.gif"><IMG ALT="b" SRC="b.gif"><IMG ALT="-" SRC="poc-empty.gif"><IMG ALT="]" SRC="poc-right.gif"></TD>
<TD>&nbsp;&nbsp;&nbsp;</TD>
<TD><A HREF="#bulk">The Bulk</A></TD></TR>

<TR><TD><IMG
ALT="[" SRC="poc-left.gif"><IMG ALT="-" SRC="poc-empty.gif"><IMG ALT="c" SRC="c.gif"><IMG ALT="-" SRC="poc-empty.gif"><IMG ALT="]" SRC="poc-right.gif"></TD>
<TD>&nbsp;&nbsp;&nbsp;</TD>
<TD><A HREF="#complete">Complete the sequence!</A></TD></TR>

<TR><TD><IMG
ALT="[" SRC="poc-left.gif"><IMG ALT="-" SRC="poc-empty.gif"><IMG ALT="d" SRC="d.gif"><IMG ALT="-" SRC="poc-empty.gif"><IMG ALT="]" SRC="poc-right.gif"></TD>
<TD>&nbsp;&nbsp;&nbsp;</TD>
<TD><A HREF="#direct">Direct Visibility</A></TD></TR>

<TR><TD><IMG
ALT="[" SRC="poc-left.gif"><IMG ALT="-" SRC="poc-empty.gif"><IMG ALT="e" SRC="e.gif"><IMG ALT="-" SRC="poc-empty.gif"><IMG ALT="]" SRC="poc-right.gif"></TD>
<TD>&nbsp;&nbsp;&nbsp;</TD>
<TD><A HREF="#expr">Complicated Expressions</A></TD></TR>

<TR><TD><IMG
ALT="[" SRC="poc-left.gif"><IMG ALT="-" SRC="poc-empty.gif"><IMG ALT="f" SRC="f.gif"><IMG ALT="-" SRC="poc-empty.gif"><IMG ALT="]" SRC="poc-right.gif"></TD>
<TD>&nbsp;&nbsp;&nbsp;</TD>
<TD><A HREF="#factor">Factorial</A></TD></TR>

<TR><TD><IMG
ALT="[" SRC="poc-left.gif"><IMG ALT="-" SRC="poc-empty.gif"><IMG ALT="g" SRC="g.gif"><IMG ALT="-" SRC="poc-empty.gif"><IMG ALT="]" SRC="poc-right.gif"></TD>
<TD>&nbsp;&nbsp;&nbsp;</TD>
<TD><A HREF="#game">The Game of Master-Mind</A></TD></TR>

<TR><TD><IMG
ALT="[" SRC="poc-left.gif"><IMG ALT="-" SRC="poc-empty.gif"><IMG ALT="h" SRC="h.gif"><IMG ALT="-" SRC="poc-empty.gif"><IMG ALT="]" SRC="poc-right.gif"></TD>
<TD>&nbsp;&nbsp;&nbsp;</TD>
<TD><A HREF="#hotline">Hotline</A></TD></TR>

<TR><TD><IMG
ALT="[" SRC="poc-left.gif"><IMG ALT="-" SRC="poc-empty.gif"><IMG ALT="i" SRC="i.gif"><IMG ALT="-" SRC="poc-empty.gif"><IMG ALT="]" SRC="poc-right.gif"></TD>
<TD>&nbsp;&nbsp;&nbsp;</TD>
<TD><A HREF="#ikeyb">I-Keyboard</A></TD></TR>

</TABLE>

<P><IMG SRC="../../img/line.gif" WIDTH=592 HEIGHT=32 BORDER=0>
<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

<H2 ALIGN="Center">Introduction</H2>

Dear contestants:

<P>
As usual, we have prepared a&nbsp;set of real-life problems for you. This time, we
are interested in the mobile communications which are becoming very popular.
A&nbsp;new company appeared on this market recently. It has French name because
French is an&nbsp;official language of communications. The name is
<EM>Association de Communication Mobile</EM> (<EM>ACM</EM>) and perhaps all of you
know enough French to understand it.

<P>
The company plans to become a&nbsp;market leader so it makes a&nbsp;lot of activities.
Beside its own GSM network, it also creates a&nbsp;new WAP portal to serve as
a&nbsp;comprehensive information source for customers having phones with WAP
browsers. Moreover, ACM also wants to produce its own cellular phone with
several smart features. Obviously, creating so many new things, the company
also faces many interesting and complex problems. Most of them can be solved
with the help of computers. Your task is to write a&nbsp;set of computer programs
to solve some of the most appealing problems.

<P>
All of the programs will run in UNIX environment. Every program should read
the data from the standard input and send results to the standard output. The
data format is given and must be exactly followed. There will be no extra
spaces in the input and there must be no extra spaces and newlines in the
output, if not stated otherwise. If the description of a&nbsp;particular problem
does not say anything else, all numbers will fit into standard signed
<EM>integer</EM> type that has 32&nbsp;bits.

<P>
We wish you a&nbsp;lot of fun and good luck with solving the problems from the
communication technology area.

<P>
Your organising team

<P><IMG SRC="../../img/line.gif" WIDTH=592 HEIGHT=32 BORDER=0>
<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

<A NAME="arith"></A><H2 ALIGN="Center">Simple Arithmetics</H2>
<P ALIGN="Center">(<B>file name:</B>
<CODE><A HREF="arith.c">arith.c</A>, <A HREF="arith.p">arith.p</A>, arith.C</CODE>)
<BR><CODE><A HREF="arith.in">arith.in</A>, <A HREF="arith.out">arith.out</A></CODE>

<P>
One part of the new WAP portal is also a&nbsp;calculator computing expressions
with very long numbers. To make the output look better, the result is
formated the same way as is it usually used with manual calculations.

<P>
Your task is to write the core part of this calculator. Given two numbers and
the requested operation, you are to compute the result and print it in the
form specified below. With addition and subtraction, the numbers are written
below each other. Multiplication is a&nbsp;little bit more complex: first of all, we
make a&nbsp;partial result for every digit of one of the numbers, and then sum the
results together.

<P>
<H3>Input Specification</H3>

<P>
There is a&nbsp;single positive integer <VAR>T</VAR> on the first line of input. It stands
for the number of expressions to follow. Each expression consists of a&nbsp;single
line containing a&nbsp;positive integer number, an&nbsp;operator (one of <TT>+</TT>,
<TT>-</TT> and <TT>*</TT>) and the second positive integer number. Every number has
at most 500&nbsp;digits. There are no spaces on the line. If the operation is
subtraction, the second number is always lower than the first one. No number
will begin with zero.

<P>
<H3>Output Specification</H3>

<P>
For each expression, print two lines with two given numbers, the second
number below the first one, last digits (representing unities) must be
aligned in the same column. Put the operator right in front of the first
digit of the second number. After the second number, there must be
a&nbsp;horizontal line made of dashes (<TT>-</TT>).

<P>
For each addition or subtraction, put the result right below the horizontal
line, with last digit aligned to the last digit of both operands.

<P>
For each multiplication, multiply the first number by each digit of the
second number. Put the partial results one below the other, starting with the
product of the last digit of the second number. Each partial result should be
aligned with the corresponding digit.
That means the last digit of the partial product must be in the same column
as the digit of the second number. No product may begin with any additional
zeros. If a&nbsp;particular digit is zero, the product has exactly one digit --
zero. If the second number has more than one digit, print another horizontal
line under the partial results, and then print the sum of them.

<P>
There must be minimal number of spaces on the beginning of lines, with
respect to other constraints. The horizontal line is always as long as
necessary to reach the left and right end of both numbers (and operators)
right below and above it. That means it begins in the same column where the
leftmost digit or operator of that two lines (one below and one above) is. It
ends in the column where is the rightmost digit of that two numbers. The line
can be neither longer nor shorter than specified.

<P>
Print one blank line after each test case, including the last one.

<H3>Sample Input</H3>

<PRE>
4
12345+67890
324-111
325*4405
1234*4
</PRE>

<H3>Sample Output</H3>

<PRE>
 12345
+67890
------
 80235

 324
-111
----
 213

    325
  *4405
  -----
   1625
     0
 1300
1300
-------
1431625

1234
  *4
----
4936
</PRE>

<P><IMG SRC="../../img/line.gif" WIDTH=592 HEIGHT=32 BORDER=0>
<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

<A NAME="bulk"></A><H2 ALIGN="Center">The Bulk</H2>
<P ALIGN="Center">(<B>file name:</B>
<CODE><A HREF="bulk.c">bulk.c</A>, <A HREF="bulk.p">bulk.p</A>, bulk.C</CODE>)
<BR><CODE><A HREF="bulk.in">bulk.in</A>, <A HREF="bulk.out">bulk.out</A></CODE>

<P>
ACM uses a&nbsp;new special technology of building its transceiver
stations. This technology is called <EM>Modular Cuboid Architecture</EM>
(<EM>MCA</EM>) and is covered by a&nbsp;patent of Lego company. All parts of
the transceiver are shipped in unit blocks that have the form of cubes of
exactly the same size. The cubes can be then connected to each other. The MCA
is modular architecture, that means we can select preferred transceiver
configuration and buy only those components we need.

<P>
The cubes must be always connected "face-to-face", i.e. the whole side of one
cube is connected to the whole side of another cube. One cube can be thus
connected to at most six other units. The resulting equipment, consisting of
unit cubes is called <EM>The Bulk</EM> in the communication technology slang.

<P>
Sometimes, an&nbsp;old and unneeded bulk is condemned, put into a&nbsp;storage place,
and replaced with a&nbsp;new one. It was recently found that ACM has many of such
old bulks that just occupy space and are no longer needed. The director has
decided that all such bulks must be disassembled to single pieces to save
some space. Unfortunately, there is no documentation for the old bulks and
nobody knows the exact number of pieces that form them. You are to write
a&nbsp;computer program that takes the bulk description and computes the number of
unit cubes.

<P>
Each bulk is described by its faces (sides). A&nbsp;special X-ray based machine
was constructed that is able to localise all faces of the bulk in the space,
even the inner faces, because the bulk can be partially hollow (it can
contain empty spaces inside). But any bulk must be connected (i.e. it cannot
drop into two pieces) and composed of whole unit cubes.

<P>
<H3>Input Specification</H3>

<P>
There is a&nbsp;single positive integer <VAR>T</VAR> on the first line of input. It stands
for the number of bulks to follow. Each bulk description begins with a&nbsp;line
containing single positive integer <VAR>F</VAR>, 6 &lt;= <VAR>F</VAR> &lt;= 250, stating the
number of faces. Then there are <VAR>F</VAR> lines, each containing one face
description. All faces of the bulk are always listed, in any order. Any
face may be divided into several distinct parts and described like if it was
more faces. Faces do not overlap. Every face has one inner
side and one outer side. No side can be "partially inner and partially
outer".

<P>
Each face is described on a&nbsp;single line. The line begins with an&nbsp;integer
number <VAR>P</VAR> stating the number of points that determine the face, 4 &lt;= <VAR>P</VAR> &lt;= 200. Then there are 3 <VAR>x P</VAR> 
numbers, coordinates of the points. Each point is described by three
coordinates <VAR>X</VAR>,<VAR>Y</VAR>,<VAR>Z</VAR> (0 &lt;= <VAR>X</VAR>,<VAR>Y</VAR>,<VAR>Z</VAR> &lt;= 1000) separated by spaces. The points
are separated from each other and from the number <VAR>P</VAR> by two space
characters. These additional spaces were added to make the input more human
readable. The face can be constructed by connecting the points in the
specified order, plus connecting the last point with the first one.

<P>
The face is always composed of "unit squares", that means every edge runs
either in <VAR>X</VAR>, <VAR>Y</VAR> or <VAR>Z</VAR>-axis direction. If we take any two neighbouring
points <VAR>X</VAR><SUB>1</SUB>,<VAR>Y</VAR><SUB>1</SUB>,<VAR>Z</VAR><SUB>1</SUB> and 
<VAR>X</VAR><SUB>2</SUB>,<VAR>Y</VAR><SUB>2</SUB>,<VAR>Z</VAR><SUB>2</SUB>, then the points will always differ in
exactly one of the three coordinates. I.e. it is either 
<VAR>X</VAR><SUB>1</SUB> &lt;&gt; <VAR>X</VAR><SUB>2</SUB>,
or 
<VAR>Y</VAR><SUB>1</SUB> &lt;&gt; <VAR>Y</VAR><SUB>2</SUB>, or 
<VAR>Z</VAR><SUB>1</SUB> &lt;&gt; <VAR>Z</VAR><SUB>2</SUB>, other two coordinates are the same. Every
face lies in an&nbsp;orthogonal plane, i.e. exactly one coordinate is always the
same for all points of the face. The face outline will never touch nor cross
itself.

<P>
<H3>Output Specification</H3>

<P>
Your program must print a&nbsp;single line for every test case. The line must
contain the sentence <TT>The bulk is composed of </TT><VAR>V</VAR><TT> units.</TT>, where <VAR>V</VAR> 
is the volume of the bulk.

<H3>Sample Input</H3>

<PRE>
2
12
4  10 10 10  10 10 20  10 20 20  10 20 10
4  20 10 10  20 10 20  20 20 20  20 20 10
4  10 10 10  10 10 20  20 10 20  20 10 10
4  10 20 10  10 20 20  20 20 20  20 20 10
4  10 10 10  10 20 10  20 20 10  20 10 10
5  10 10 20  10 20 20  20 20 20  20 15 20  20 10 20
4  14 14 14  14 14 16  14 16 16  14 16 14
4  16 14 14  16 14 16  16 16 16  16 16 14
4  14 14 14  14 14 16  16 14 16  16 14 14
4  14 16 14  14 16 16  16 16 16  16 16 14
4  14 14 14  14 16 14  16 16 14  16 14 14
4  14 14 16  14 16 16  16 16 16  16 14 16
12
4  20 20 30  20 30 30  30 30 30  30 20 30
4  10 10 10  10 40 10  40 40 10  40 10 10
6  10 10 20  20 10 20  20 30 20  30 30 20  30 40 20  10 40 20
6  20 10 20  20 20 20  30 20 20  30 40 20  40 40 20  40 10 20
4  10 10 10  40 10 10  40 10 20  10 10 20
4  10 40 10  40 40 10  40 40 20  10 40 20
4  20 20 20  30 20 20  30 20 30  20 20 30
4  20 30 20  30 30 20  30 30 30  20 30 30
4  10 10 10  10 40 10  10 40 20  10 10 20
4  40 10 10  40 40 10  40 40 20  40 10 20
4  20 20 20  20 30 20  20 30 30  20 20 30
4  30 20 20  30 30 20  30 30 30  30 20 30
</PRE>

<H3>Sample Output</H3>

<PRE>
The bulk is composed of 992 units.
The bulk is composed of 10000 units.
</PRE>

<P><IMG SRC="../../img/line.gif" WIDTH=592 HEIGHT=32 BORDER=0>
<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

<A NAME="complete"></A><H2 ALIGN="Center">Complete the sequence!</H2>
<P ALIGN="Center">(<B>file name:</B>
<CODE><A HREF="complete.c">complete.c</A>, <A HREF="complete.p">complete.p</A>, complete.C</CODE>)
<BR><CODE><A HREF="complete.in">complete.in</A>, <A HREF="complete.out">complete.out</A></CODE>

<P>
You probably know those quizzes in Sunday magazines: given the sequence 1, 2,
3, 4, 5, what is the next number? Sometimes it is very easy to answer,
sometimes it could be pretty hard. Because these "sequence problems" are very
popular, ACM wants to implement them into the "Free Time" section of their
new WAP portal.

<P>
ACM programmers have noticed that some of the quizzes can be solved by
describing the sequence by polynomials. For example, the sequence 1, 2, 3, 4, 5
can be easily understood as a&nbsp;trivial polynomial. The next number is 6. But even
more complex sequences, like 1, 2, 4, 7, 11, can be described by a&nbsp;polynomial.
In this case, 
1/2.<VAR>n</VAR><SUP>2</SUP>-1/2.<VAR>n</VAR>+1 can be used. Note that even
if the members of the sequence are integers, polynomial coefficients may be any
real numbers.

<P>
Polynomial is an&nbsp;expression in the following form:
<BR><P></P>
<DIV ALIGN="CENTER">
<VAR>P</VAR>(<VAR>n</VAR>) = <VAR>a</VAR><SUB><VAR>D</VAR></SUB>.<VAR>n</VAR><SUP><VAR>D</VAR></SUP>+<VAR>a</VAR><SUB><VAR>D</VAR>-1</SUB>.<VAR>n</VAR><SUP><VAR>D</VAR>-1</SUP>+...+<VAR>a</VAR><SUB>1</SUB>.<VAR>n</VAR>+<VAR>a</VAR><SUB>0</SUB>
</DIV>
<BR CLEAR="ALL">
<P></P>.
If <VAR>a</VAR><SUB><VAR>D</VAR></SUB> &lt;&gt; 0, the number <VAR>D</VAR> is called a&nbsp;<EM>degree</EM> of the polynomial. Note
that constant function <VAR>P</VAR>(<VAR>n</VAR>) = <VAR>C</VAR> can be considered as polynomial of degree 0, and
the zero function <VAR>P</VAR>(<VAR>n</VAR>) = 0 is usually defined to have degree -1.

<P>
<H3>Input Specification</H3>

<P>
There is a&nbsp;single positive integer <VAR>T</VAR> on the first line of input. It stands
for the number of test cases to follow. Each test case consists of two
lines. First line of each test case contains two integer numbers <VAR>S</VAR> and
<VAR>C</VAR> separated by a&nbsp;single space, 
1 &lt;= <VAR>S</VAR> &lt; 100, 
1 &lt;= <VAR>C</VAR> &lt; 100,

(<VAR>S</VAR>+<VAR>C</VAR>) &lt;= 100. The first number, <VAR>S</VAR>, stands for the length of the given
sequence, the second number, <VAR>C</VAR> is the amount of numbers you are to find to
complete the sequence.

<P>
The second line of each test case contains <VAR>S</VAR> integer numbers

<VAR>X</VAR><SUB>1</SUB>, <VAR>X</VAR><SUB>2</SUB>, ... <VAR>X</VAR><SUB><VAR>S</VAR></SUB> separated by a&nbsp;space. These numbers form the given
sequence. The sequence can always be described by a&nbsp;polynomial <VAR>P</VAR>(<VAR>n</VAR>) 
such that for every <VAR>i</VAR>, 
<VAR>X</VAR><SUB><VAR>i</VAR></SUB> = <VAR>P</VAR>(<VAR>i</VAR>). Among these polynomials, we can find the
polynomial <VAR>P</VAR><SUB><VAR>min</VAR></SUB> with the lowest possible degree. This polynomial should be
used for completing the sequence.

<P>
<H3>Output Specification</H3>

<P>
For every test case, your program must print a&nbsp;single line containing <VAR>C</VAR> 
integer numbers, separated by a&nbsp;space. These numbers are the values
completing the sequence according to the polynomial of the lowest possible
degree. In other words, you are to print values

<VAR>P</VAR><SUB><VAR>min</VAR></SUB>(<VAR>S</VAR>+1), <VAR>P</VAR><SUB><VAR>min</VAR></SUB>(<VAR>S</VAR>+2), .... <VAR>P</VAR><SUB><VAR>min</VAR></SUB>(<VAR>S</VAR>+<VAR>C</VAR>).

<P>
It is guaranteed that the results 
<VAR>P</VAR><SUB><VAR>min</VAR></SUB>(<VAR>S</VAR>+<VAR>i</VAR>) will be non-negative and
will fit into the standard <EM>integer</EM> type.

<H3>Sample Input</H3>

<PRE>
4
6 3
1 2 3 4 5 6
8 2
1 2 4 7 11 16 22 29
10 2
1 1 1 1 1 1 1 1 1 2
1 10
3
</PRE>

<H3>Sample Output</H3>

<PRE>
7 8 9
37 46
11 56
3 3 3 3 3 3 3 3 3 3
</PRE>

<P><IMG SRC="../../img/line.gif" WIDTH=592 HEIGHT=32 BORDER=0>
<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

<A NAME="direct"></A><H2 ALIGN="Center">Direct Visibility</H2>
<P ALIGN="Center">(<B>file name:</B>
<CODE><A HREF="direct.c">direct.c</A>, <A HREF="direct.p">direct.p</A>, direct.C</CODE>)
<BR><CODE><A HREF="direct.in">direct.in</A>, <A HREF="direct.out">direct.out</A></CODE>

<P>
Building the GSM network is a&nbsp;very expensive and complex task. Moreover,
after the <EM>Base Transceiver Stations</EM> (<EM>BTS</EM>) are built and
working, we need to perform many various measurements to determine the state
of the network, and propose effective improvements to be made.

<P>
The ACM technicians have a&nbsp;special equipment for measuring the strength of
electro-magnetic fields, the transceivers' power and quality of the signal.
This equipment is packed into a&nbsp;huge knapsack and the technician must move
with it from one BTS to another. Unfortunately, the knapsack have not enough
memory for storing all of the measured values. It has a&nbsp;small cache only,
that can store values for several seconds. Then the values must be
transmitted to the BTS by an&nbsp;infrared connection (IRDA). The IRDA needs
direct visibility between the technician and the BTS.

<P>
Your task is to find the path between two neighbouring BTSes such that at
least one of those BTSes is always visible.

<P>
<H3>Input Specification</H3>

<P>
There is a&nbsp;single positive integer <VAR>T</VAR> on the first line of input. It stands
for the number of test cases to follow. Each test case consists of a&nbsp;town
description. For simplicity, a&nbsp;town is modelled as a&nbsp;rectangular grid of
<VAR>P x Q</VAR> square fields. Each field is exactly 1&nbsp;metre wide. For each
field, a&nbsp;non-negative integer <VAR>Z</VAR><SUB><VAR>i</VAR>,<VAR>j</VAR></SUB> is given, representing the height of
the terrain in that place, in metres. That means the town model is made of
cubes, each of them being either solid or empty. There are no "half solid"
cubes.

<P>
The first line of each test case contains two integer numbers <VAR>P</VAR> and <VAR>Q</VAR>,
separated by a&nbsp;single space, 
1 &lt;= <VAR>P</VAR>,<VAR>Q</VAR> &lt;= 200. Then there are <VAR>P</VAR> lines
each containing <VAR>Q</VAR> integer numbers separated by a&nbsp;space. These numbers are
<VAR>Z</VAR><SUB><VAR>i</VAR>,<VAR>j</VAR></SUB>, where 
1 &lt;= <VAR>i</VAR> &lt;= <VAR>P</VAR>, 
1 &lt;= <VAR>j</VAR> &lt;= <VAR>Q</VAR> and

0 &lt;= <VAR>Z</VAR><SUB><VAR>i</VAR>,<VAR>j</VAR></SUB> &lt;= 5000. After the terrain
description, there are four numbers 
<VAR>R</VAR><SUB>1</SUB>, <VAR>C</VAR><SUB>1</SUB>, <VAR>R</VAR><SUB>2</SUB>, <VAR>C</VAR><SUB>2</SUB> on the last line of
each test case. These numbers represent position of two
BTSes, 
1 &lt;= <VAR>R</VAR><SUB>1</SUB>,<VAR>R</VAR><SUB>2</SUB> &lt;= <VAR>P</VAR>, 
1 &lt;= <VAR>C</VAR><SUB>1</SUB>,<VAR>C</VAR><SUB>2</SUB> &lt;= <VAR>Q</VAR>. The first coordinate
(<VAR>R</VAR>) determines the row of the town, the second coordinate determines the
column.

<P>
The technician is moving in steps (<EM>steps</EM> stands for
<EM>Standard Technician's Elementary Positional Shift</EM>). Each step is made
between two neighbouring square fields. That means the step is always in
North, South, West or East direction. It is not possible to move diagonally.
The step between two fields <VAR>A</VAR> and <VAR>B</VAR> (step from <VAR>A</VAR> to <VAR>B</VAR>) is allowed
only if the height of the terrain in the field <VAR>B</VAR> is not very different from
the height in the field <VAR>A</VAR>. The technician can climb at most 1&nbsp;metre up or
descend at most 3&nbsp;metres down in a&nbsp;single step.

<P>
At the end of each step, at least one of the two BTSes must be visible.
However, there can be some point "in the middle of the step" where no BTS
is visible. This is OK and the data is handled by the cache. The BTS is
considered visible, if there is a&nbsp;direct visibility between the unit cube
just above the terrain on the BTSes coordinates and the cube just above the
terrain on the square field, where the technician is. Direct visibility
between two cubes means that the line connecting the centres of the two cubes
does not intersect any solid cube. However, the line can touch any number of
solid cubes. In other words, consider both the BTS and the technician being
points exactly half metre above the surface and in the centre of the
appropriate square field.

<P>
Note that the IRDA beam can go between two cubes that touch each other by
their edge, although there is no space between them. It is because such
a&nbsp;beam touches both of these two cubes but does not intersect any of
them. See the last test case of the sample input for an&nbsp;example of such
a&nbsp;situation.

<P>
<H3>Output Specification</H3>

<P>
You are to find the shortest possible path meeting the above criteria. All
steps must be done between neighbouring fields, the terrain must not elevate
or descend too much, and at the end of each step, at least one BTS must be
visible.

<P>
For each test case, print one line containing the sentence
<TT>The shortest path is </TT><VAR>M</VAR><TT> steps long.</TT>, where <VAR>M</VAR> is the number of
steps that must be made. If there is no such path, output the sentence
<TT>Mission impossible!</TT>.

<H3>Sample Input</H3>

<PRE>
4
5 5
8 7 6 5 4
2 2 2 2 2
2 2 2 2 2
2 2 2 2 2
2 2 2 2 2
1 1 5 1
5 8
2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2
9 9 9 9 9 9 9 2
2 2 2 2 2 2 2 2
1 2 5 1
5 8
2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2
2 2 2 2 2 2 2 2
9 9 9 9 9 9 9 2
2 2 2 2 2 2 2 2
1 5 5 1
6 12
5 5 5 5 1 5 5 5 5 5 5 5
5 5 5 5 1 5 5 5 5 5 5 5
5 5 5 5 9 5 5 5 5 5 5 5
5 9 1 5 5 5 5 5 5 5 5 5
5 5 9 5 5 5 5 5 5 5 5 5
5 5 9 5 5 5 5 5 5 5 5 5
6 1 3 12
</PRE>

<H3>Sample Output</H3>

<PRE>
The shortest path is 10 steps long.
Mission impossible!
The shortest path is 14 steps long.
The shortest path is 18 steps long.
</PRE>

<P><IMG SRC="../../img/line.gif" WIDTH=592 HEIGHT=32 BORDER=0>
<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

<A NAME="expr"></A><H2 ALIGN="Center">Complicated Expressions</H2>
<P ALIGN="Center">(<B>file name:</B>
<CODE><A HREF="expr.c">expr.c</A>, <A HREF="expr.p">expr.p</A>, expr.C</CODE>)
<BR><CODE><A HREF="expr.in">expr.in</A>, <A HREF="expr.out">expr.out</A></CODE>

<P>
The most important activity of ACM is the GSM network. As the mobile phone
operator, ACM must build its own transmitting stations. It is very important
to compute the exact behaviour of electro-magnetic waves. Unfortunately,
prediction of electro-magnetic fields is a&nbsp;very complex task and the
formulas describing them are very long and hard-to-read. For
example, below are the Maxwell's Equations describing the basic laws of
electrical engineering.

<TABLE>
<TR><TD>
<IMG
 WIDTH="51" HEIGHT="18" ALIGN="BOTTOM" BORDER="0"
 SRC="img2.gif"
 >
</TD><TD>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</TD><TD>
<IMG
 WIDTH="57" HEIGHT="34" ALIGN="MIDDLE" BORDER="0"
 SRC="img3.gif"
 >
</TD></TR><TR><TD>
<IMG
 WIDTH="97" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img4.gif"
 >
</TD><TD>
</TD><TD>
<IMG
 WIDTH="82" HEIGHT="37" ALIGN="MIDDLE" BORDER="0"
 SRC="img5.gif"
 >
</TD></TR>
</TABLE>

ACM has designed its own computer system that can make some field
computations and produce results in the form of mathematic expressions.
Unfortunately, by generating the expression in several steps, there are
always some unneeded parentheses inside the expression. Your task is to take
these partial results and make them "nice" by removing all unnecessary
parentheses.

<P>
<H3>Input Specification</H3>

<P>
There is a&nbsp;single positive integer <VAR>T</VAR> on the first line of input. It stands
for the number of expressions to follow. Each expression consists of a&nbsp;single
line containing only lowercase letters, operators (<TT>+</TT>, <TT>-</TT>, <TT>*</TT>,
<TT>/</TT>) and parentheses (<TT>(</TT> and <TT>)</TT>). The letters are variables
that can have any value, operators and parentheses have their usual meaning.
Multiplication and division have higher priority then subtraction and
addition. All operations with the same priority are computed from left to
right (operators are left-associative). There are no spaces inside the
expressions. No input line contains more than 250 characters.

<P>
<H3>Output Specification</H3>

<P>
Print a&nbsp;single line for every expression. The line must contain the same
expression with unneeded parentheses removed. You must remove as many
parentheses as possible without changing the semantics of the expression.
The semantics of the expression is considered the same if and only if any of
the following conditions hold:
<UL>
<LI>The ordering of operations remains the same. That means "(<VAR>a</VAR>+<VAR>b</VAR>)+<VAR>c</VAR>" is
  the same as "<VAR>a</VAR>+<VAR>b</VAR>+<VAR>c</VAR>", and "<VAR>a</VAR>+(<VAR>b</VAR>/<VAR>c</VAR>)" is the same as "<VAR>a</VAR>+<VAR>b</VAR>/<VAR>c</VAR>".
<LI>The order of some operations is swapped but the result remains unchanged
  with respect to the addition and multiplication associativity.
  That means "<VAR>a</VAR>+(<VAR>b</VAR>+<VAR>c</VAR>)" and "(<VAR>a</VAR>+<VAR>b</VAR>)+<VAR>c</VAR>" are the same. We can also combine
  addition with subtraction and multiplication with division, if the
  subtraction or division is the second operation. For example, "<VAR>a</VAR>+(<VAR>b</VAR>-<VAR>c</VAR>)"
  is the same as "<VAR>a</VAR>+<VAR>b</VAR>-<VAR>c</VAR>".
</UL>
<P>
You cannot use any other laws, namely you cannot swap left and right
operands and you cannot replace "<VAR>a</VAR>-(<VAR>b</VAR>-<VAR>c</VAR>)" with "<VAR>a</VAR>-<VAR>b</VAR>+<VAR>c</VAR>".

<H3>Sample Input</H3>

<PRE>
8
(a+(b*c))
((a+b)*c)
(a*(b*c))
(a*(b/c)*d)
((a/(b/c))/d)
((x))
(a+b)-(c-d)-(e/f)
(a+b)+(c-d)-(e+f)
</PRE>

<H3>Sample Output</H3>

<PRE>
a+b*c
(a+b)*c
a*b*c
a*b/c*d
a/(b/c)/d
x
a+b-(c-d)-e/f
a+b+c-d-(e+f)
</PRE>

<P><IMG SRC="../../img/line.gif" WIDTH=592 HEIGHT=32 BORDER=0>
<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

<A NAME="factor"></A><H2 ALIGN="Center">Factorial</H2>
<P ALIGN="Center">(<B>file name:</B>
<CODE><A HREF="factor.c">factor.c</A>, <A HREF="factor.p">factor.p</A>, factor.C</CODE>)
<BR><CODE><A HREF="factor.in">factor.in</A>, <A HREF="factor.out">factor.out</A></CODE>

<P>
The most important part of a&nbsp;GSM network is so called
<EM>Base Transceiver Station</EM> (<EM>BTS</EM>). These transceivers form the
areas called <EM>cells</EM> (this term gave the name to the cellular phone)
and every phone connects to the BTS with the strongest signal (in
a&nbsp;little simplified view). Of course, BTSes need some attention and
technicians need to check their function periodically.

<P>
ACM technicians faced a&nbsp;very interesting problem recently. Given a&nbsp;set of
BTSes to visit, they needed to find the shortest path to visit all of the
given points and return back to the central company building. Programmers
have spent several months studying this problem but with no results. They
were unable to find the solution fast enough. After a&nbsp;long time, one of the
programmers found this problem in a&nbsp;conference article. Unfortunately, he
found that the problem is so called "Travelling Salesman Problem" and it is
very hard to solve. If we have <VAR>N</VAR> BTSes to be visited, we can visit them in
any order, giving us <VAR>N</VAR>! possibilities to examine. The function expressing
that number is called factorial and can be computed as a&nbsp;product

1.2.3.4....<VAR>N</VAR>. The number is very high even for a&nbsp;relatively small <VAR>N</VAR>.

<P>
The programmers understood they had no chance to solve the problem. But
because they have already received the research grant from the government,
they needed to continue with their studies and produce at least <EM>some</EM>
results. So they started to study behaviour of the factorial function.

<P>
For example, they defined the function <VAR>Z</VAR>. For any positive integer <VAR>N</VAR>,
<VAR>Z</VAR>(<VAR>N</VAR>) is the number of zeros at the end of the decimal form of number
<VAR>N</VAR>!. They noticed that this function never decreases. If we have two numbers
<VAR>N</VAR><SUB>1</SUB>&lt;<VAR>N</VAR><SUB>2</SUB>, then 
<VAR>Z</VAR>(<VAR>N</VAR><SUB>1</SUB>) &lt;= <VAR>Z</VAR>(<VAR>N</VAR><SUB>2</SUB>). It is because we can never "lose" any
trailing zero by multiplying by any positive number. We can only get new
and new zeros. The function <VAR>Z</VAR> is very interesting, so we need a&nbsp;computer
program that can determine its value efficiently.

<P>
<H3>Input Specification</H3>

<P>
There is a&nbsp;single positive integer <VAR>T</VAR> on the first line of input. It stands
for the number of numbers to follow. Then there is <VAR>T</VAR> lines, each containing
exactly one positive integer number <VAR>N</VAR>, 
1 &lt;= <VAR>N</VAR> &lt;= 1000000000.

<P>
<H3>Output Specification</H3>

<P>
For every number <VAR>N</VAR>, output a&nbsp;single line containing the single non-negative
integer <VAR>Z</VAR>(<VAR>N</VAR>).

<H3>Sample Input</H3>

<PRE>
6
3
60
100
1024
23456
8735373
</PRE>

<H3>Sample Output</H3>

<PRE>
0
14
24
253
5861
2183837
</PRE>

<P><IMG SRC="../../img/line.gif" WIDTH=592 HEIGHT=32 BORDER=0>
<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

<A NAME="game"></A><H2 ALIGN="Center">The Game of Master-Mind</H2>
<P ALIGN="Center">(<B>file name:</B>
<CODE><A HREF="game.c">game.c</A>, <A HREF="game.p">game.p</A>, game.C</CODE>)
<BR><CODE><A HREF="game.in">game.in</A>, <A HREF="game.out">game.out</A></CODE>

<P>
If you want to buy a&nbsp;new cellular phone, there are many various types to
choose from. To decide which one is the best for you, you have to consider
several important things: its size and weight, battery capacity, WAP support,
colour, price. One of the most important things is also the list of games the
phone provides. Nokia is one of the most successful phone makers because of
its famous Snake and Snake&nbsp;II. ACM wants to make and sell its own phone and
they need to program several games for it. One of them is Master-Mind, the
famous board logical game.

<P>
The game is played between two players. One of them chooses a&nbsp;<EM>secret code</EM>
consisting of <VAR>P</VAR>&nbsp;ordered pins, each of them having one of the predefined set of
<VAR>C</VAR>&nbsp;colours. The goal of the second player is to guess that secret sequence of
colours. Some colours may not appear in the code, some colours may appear more
than once.

<P>
The player makes guesses, which are formed in the same way as the secret
code. After each guess, he/she is provided with an&nbsp;information on how
successful the guess was. This feedback is called a&nbsp;<EM>hint</EM>. Each hint
consists of <VAR>B</VAR> black points and <VAR>W</VAR> white points. The black point stands for
every pin that was guessed right, i.e. the right colour was put on the right
position. The white point means right colour but on the wrong position. For
example, if the secret code is "white, yellow, red, blue, white" and the
guess was "white, red, white, white, blue", the hint would consist of one
black point (for the white on the first position) and three white points
(for the other white, red and blue colours). The goal is to guess the
sequence with the minimal number of hints.

<P>
The new ACM phone should have the possibility to play both roles. It can make
the secret code and give hints, but it can also make its own guesses. Your
goal is to write a&nbsp;program for the latter case, that means a&nbsp;program that
makes Master-Mind guesses.

<P>
<H3>Input Specification</H3>

<P>
There is a&nbsp;single positive integer <VAR>T</VAR> on the first line of input. It stands
for the number of test cases to follow. Each test case describes one game
situation and you are to make a&nbsp;guess. On the first line of each test case,
there are three integer numbers, <VAR>P</VAR>, <VAR>C</VAR> and <VAR>M</VAR>. <VAR>P</VAR> (
1 &lt;= <VAR>P</VAR> &lt;= 10) is
the number of pins, <VAR>C</VAR> (1 &lt;= <VAR>C</VAR> &lt;= 100) is the number of colours, and <VAR>M</VAR> 
(1 &lt;= <VAR>M</VAR> &lt;= 100) is the number of already played guesses.

<P>
Then there are 2 <VAR>x M</VAR> lines, two lines for every guess. At the first line of
each guess, there are <VAR>P</VAR> integer numbers representing colours of the guess.
Each colour is represented by a&nbsp;number <VAR>G</VAR><SUB><VAR>i</VAR></SUB>, 
1 &lt;= <VAR>G</VAR><SUB><VAR>i</VAR></SUB> &lt;= <VAR>C</VAR>. The second
line contains two integer numbers, <VAR>B</VAR> and <VAR>W</VAR>, stating for the number of
black and white points given by the corresponding hint.

<P>
Let's have a&nbsp;secret code 
<VAR>S</VAR><SUB>1</SUB>, <VAR>S</VAR><SUB>2</SUB>, ... <VAR>S</VAR><SUB><VAR>P</VAR></SUB> and the guess

<VAR>G</VAR><SUB>1</SUB>, <VAR>G</VAR><SUB>2</SUB>, ... <VAR>G</VAR><SUB><VAR>P</VAR></SUB>. Then we can make a&nbsp;set <VAR>H</VAR> containing pairs of numbers
(<VAR>I</VAR>,<VAR>J</VAR>) such that <VAR>S</VAR><SUB><VAR>I</VAR></SUB> = <VAR>G</VAR><SUB><VAR>J</VAR></SUB>, and that any number can appear at most once on
the first position and at most once on the second position. That means for
every two different pairs from that set, (<VAR>I</VAR><SUB>1</SUB>,<VAR>J</VAR><SUB>1</SUB>) and (<VAR>I</VAR><SUB>2</SUB>,<VAR>J</VAR><SUB>2</SUB>), we
have 
<VAR>I</VAR><SUB>1</SUB> &lt;&gt; <VAR>I</VAR><SUB>2</SUB> and 
<VAR>J</VAR><SUB>1</SUB> &lt;&gt; <VAR>J</VAR><SUB>2</SUB>. Then we denote <VAR>B</VAR>(<VAR>H</VAR>) the number of
pairs in the set, that meet the condition <VAR>I</VAR> = <VAR>J</VAR>, and <VAR>W</VAR>(<VAR>H</VAR>) the number of
pairs with <VAR>I</VAR> &lt;&gt; <VAR>J</VAR>.

<P>
We define an&nbsp;ordering of every two possible sets <VAR>H</VAR><SUB>1</SUB> and <VAR>H</VAR><SUB>2</SUB>. Let's say

<VAR>H</VAR><SUB>1</SUB> &lt;= <VAR>H</VAR><SUB>2</SUB> if and only if one of the following holds:
<UL>
<LI>
<VAR>B</VAR>(<VAR>H</VAR><SUB>1</SUB>) &lt; <VAR>B</VAR>(<VAR>H</VAR><SUB>2</SUB>), or
<LI>
<VAR>B</VAR>(<VAR>H</VAR><SUB>1</SUB>)  =  <VAR>B</VAR>(<VAR>H</VAR><SUB>2</SUB>) and 
<VAR>W</VAR>(<VAR>H</VAR><SUB>1</SUB>) &lt;= <VAR>W</VAR>(<VAR>H</VAR><SUB>2</SUB>)</UL>Then we can find a&nbsp;maximal set <VAR>H</VAR><SUB><VAR>max</VAR></SUB> according to this ordering. The
numbers 
<VAR>B</VAR>(<VAR>H</VAR><SUB><VAR>max</VAR></SUB>) and 
<VAR>W</VAR>(<VAR>H</VAR><SUB><VAR>max</VAR></SUB>) are the black and white points for that
hint.

<P>
<H3>Output Specification</H3>

<P>
For every test case, print the line containing <VAR>P</VAR> numbers representing <VAR>P</VAR> 
colours of the next guess. Your guess must be valid according to all previous
guesses and hints. The guess is valid if the sequence could be a&nbsp;secret code,
i.e. the sequence was not eliminated by previous guesses and hints.

<P>
If there is no valid guess possible, output the sentence
<TT>You are cheating!</TT>. If there are more valid guesses, output the one
that is lexicographically smallest. I.e. find such guess <VAR>G</VAR> that for every
other valid guess <VAR>V</VAR> there exists such a&nbsp;number <VAR>I</VAR> that:
<UL>
<LI><VAR>G</VAR><SUB><VAR>J</VAR></SUB> = <VAR>V</VAR><SUB><VAR>J</VAR></SUB> for every <VAR>J</VAR>&lt;<VAR>I</VAR>, and
<LI><VAR>G</VAR><SUB><VAR>I</VAR></SUB>&lt;<VAR>V</VAR><SUB><VAR>I</VAR></SUB>.
</UL>

<H3>Sample Input</H3>

<PRE>
3
4 3 2
1 2 3 2
1 1
2 1 3 2
1 1
4 6 2
3 3 3 3
3 0
4 4 4 4
2 0
8 9 3
1 2 3 4 5 6 7 8
0 0
2 3 4 5 6 7 8 9
1 0
3 4 5 6 7 8 9 9
2 0
</PRE>

<H3>Sample Output</H3>

<PRE>
1 1 1 3
You are cheating!
9 9 9 9 9 9 9 9
</PRE>

<P><IMG SRC="../../img/line.gif" WIDTH=592 HEIGHT=32 BORDER=0>
<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

<A NAME="hotline"></A><H2 ALIGN="Center">Hotline</H2>
<P ALIGN="Center">(<B>file name:</B>
<CODE><A HREF="hotline.c">hotline.c</A>, <A HREF="hotline.p">hotline.p</A>, hotline.C</CODE>)
<BR><CODE><A HREF="hotline.in">hotline.in</A>, <A HREF="hotline.out">hotline.out</A></CODE>

<P>
Every customer sometimes needs help with new and unusual products. Therefore,
hotline service is very important for every company. We need a&nbsp;single phone
number where the customer can always find a&nbsp;friendly voice ready to help with
anything. On the other hand, many people are needed to serve as hotline
operators, and human resources are always very expensive. Moreover, it is not
easy to pretend "friendly voice" at 4am and explain to a&nbsp;drunken man that you
are really unable to give him the number to House of Parliament. It was
also found that some of the questions repeat very often and it is very
annoying to answer them again and again.

<P>
ACM is a&nbsp;modern company, wanting to solve its hotline problem. They want
to decrease the number of human operators by creating a&nbsp;complex software
system that would be able to answer most common questions. The customer's
voice is analysed by a&nbsp;special Voice Recognition Module (VRM) and converted
to a&nbsp;plain text. The text is then taken by an Artificial Automatic Adaptive
Answering Algorithm (AAAAA). The most common questions are recognised and
answered automatically. The replies are then converted to a&nbsp;sound by
Text-to-Speech Module (TTS).

<P>
You are to write the AAAAA module. Because your algorithm should be adaptive,
it has no explicit knowledge base. But it must be able to listen to sentences
in English and remember the mentioned facts. Whenever the question is asked
about such a&nbsp;fact, the system has to answer it properly. The VRM and TTS
modules are already implemented, so the input and output of AAAAA will be in
the text form.

<P>
<H3>Input Specification</H3>

<P>
There is a&nbsp;single positive integer <VAR>T</VAR> on the first line of input. It stands
for the number of dialogues to follow. Each dialogue consists of zero or more
lines, each of them containing one sentence: either statement or question. The
statement ends with a&nbsp;dot character (<TT>.</TT>), the question ends with
a&nbsp;question mark (<TT>?</TT>). No statement will appear more than once, however
the questions can be repeated. There is one extra line after each dialogue.
That line ends with an&nbsp;exclamation mark (<TT>!</TT>).

<P>
Sentences can contain words, spaces and punctuation characters (such as
commas, colons, semicolons etc.). All words contain only letters of English
alphabet and are case-sensitive. That means the same word is always written
the same way, usually in lowercase. Acronyms, names and some other words can
begin with capital letters. For simplicity, all sentences begin with
a&nbsp;lowercase letter. Only if the first word should be written with a&nbsp;capital,
the sentence begins with a&nbsp;capital letter. There are no unneeded spaces
between words. No line will have more than 100 characters. There will be at
most 100 statements per each test case.

<P>

<H3>Statements</H3>

<P>
Each statement has one of the following two forms ( <IMG  SRC="thespace.gif"> denotes a&nbsp;space):
<BR>
<I>subject</I>  <IMG  SRC="thespace.gif"> <I>predicate</I>[<TT>s</TT>] [ <IMG  SRC="thespace.gif"> <I>object</I>] <TT>.</TT>
<BR>
<I>subject</I>  <IMG  SRC="thespace.gif"> <TT>don't</TT>|<TT>doesn't</TT>  <IMG  SRC="thespace.gif"> <I>predicate</I> [ <IMG  SRC="thespace.gif"> <I>object</I>] <TT>.</TT>

<P>
The square brackets mark an&nbsp;optional part, the vertical line two possible
variants. Subject is a&nbsp;single word, noun or pronoun in singular. Predicate is
a&nbsp;verb (single word) denoting some activity. Object can be any text. Object
does not contain any dots. Any pair "verb + object" determines unique
activity. The same verb with different objects makes different independent
activities, i.e. the different and independent meaning of the sentence.
Sentence without any object can be considered as sentence with an&nbsp;empty
object. The verb without an&nbsp;object has different and independent meaning than
the same verb with any non-empty object.

<P>
The first variant of sentence denotes a&nbsp;positive statement. The word
"<I>predicate</I>[<TT>s</TT>]" means verb that matches the subject of the sentence.
If the subject is "<TT>I</TT>" or "<TT>you</TT>", the verb has the same form as the
infinitive. With any other subject, the letter "<TT>s</TT>" is appended on the
end of the verb. Assume there are no irregular verbs.

<P>
The second variant is a&nbsp;negative statement. Verb "<TT>don't</TT>" or
"<TT>doesn't</TT>" must also match the subject. The form "<TT>don't</TT>" is used
with either "<TT>I</TT>" or "<TT>you</TT>", "<TT>doesn't</TT>" is used in any other
case.

<P>
A&nbsp;special generic subject "<TT>everybody</TT>" can be used. It means the activity
holds for any subject. Other special subject is "<TT>nobody</TT>". Such sentence
also holds for any subject, but its meaning is negative. Both of these generic
subjects can be used with the first variant only (without "<TT>doesn't</TT>").
The sentence "<TT>nobody likes something</TT>" is exactly equal to
"<TT>everybody doesn't like something</TT>", except the latter form will never
occur in the input.

<P>

<H3>Questions</H3>

<P>
Each question has one of the following three forms:
<DL COMPACT>
<DT>1.
<DD><TT>do</TT>|<TT>does</TT>  <IMG  SRC="thespace.gif"> <I>subject</I>  <IMG  SRC="thespace.gif"> <I>predicate</I> [ <IMG  SRC="thespace.gif"> object] <TT>?</TT>
<DT>2.
<DD><TT>who</TT>  <IMG  SRC="thespace.gif"> <I>predicate</I><TT>s</TT> [ <IMG  SRC="thespace.gif"> <I>object</I>] <TT>?</TT>
<DT>3.
<DD><TT>what</TT>  <IMG  SRC="thespace.gif"> <TT>do</TT>|<TT>does</TT>  <IMG  SRC="thespace.gif"> <I>subject</I> <TT>do</TT> <TT>?</TT>
</DL>
<P>
The word "<TT>do</TT>|<TT>does</TT>" always matches the subject ("<TT>do I?</TT>",
"<TT>do you?</TT>", "<TT>does</TT> any other subject?"). In the second
type of question, predicate always matches the word "<TT>who</TT>", i.e. the
"<TT>s</TT>" is always appended. Generic subjects cannot be used in questions.

<P>
<H3>Output Specification</H3>

<P>
For each dialogue, your program must output the line <TT>Dialogue #</TT><VAR>D</VAR><TT>:</TT>,
where <VAR>D</VAR> is the sequence number of dialogue, starting with 1. Then print
exactly three lines for every question: the first line repeats the question,
the second line contains the answer, and the third line is empty. Print
nothing for statements. After each dialogue, print the same line with
an&nbsp;exclamation mark that was in the input. Then print one extra empty line.
Empty line contains a&nbsp;new-line character only.

<P>
The answer must be properly formated to be accepted by a&nbsp;TTS module. Only the
statements appearing in the input before the answer are used for the
corresponding reply. If there is any contradiction among statements, the
reply is always <TT>I am abroad.</TT>. If the question and statements consider
the special subject "<TT>you</TT>", it must be replaced with "<TT>I</TT>" in the
answer. If the question considers special subject "<TT>I</TT>", it must be
replaced with "<TT>you</TT>" in the answer. The verb must always match the
subject of the sentence. The exact form of the correct answer depends on the
type of question.

<P>

<H3>1.&nbsp;does subject predicate [object] ?</H3>

<P>
If there is any positive statement about the mentioned subject (or
generic subject "<TT>everybody</TT>"), predicate and object, the answer is:
<BR>
<TT>yes,</TT>  <IMG  SRC="thespace.gif"> <I>subject</I>  <IMG  SRC="thespace.gif"> <I>predicate</I>[<TT>s</TT>] [ <IMG  SRC="thespace.gif"> <I>object</I>] <TT>.</TT>

<P>
If there is any negative statement about the mentioned subject (or
generic subject "<TT>nobody</TT>"), predicate and object, the answer is:
<BR>
<TT>no,</TT>  <IMG  SRC="thespace.gif"> <I>subject</I>  <IMG  SRC="thespace.gif"> <TT>don't</TT>|<TT>doesn't</TT>  <IMG  SRC="thespace.gif"> <I>predicate</I> [ <IMG  SRC="thespace.gif"> <I>object</I>] <TT>.</TT>

<P>
Otherwise, the answer is:
<TT>maybe.</TT>

<P>
Subject in the answer is always the same subject as the subject of the
question.

<P>

<H3>2.&nbsp;who predicates [object] ?</H3>

<P>
If there is a&nbsp;positive statement considering any subject, the specified
predicate and object, the answer is:
<BR>
<I>subject</I>  <IMG  SRC="thespace.gif"> <I>predicate</I>[<TT>s</TT>] [ <IMG  SRC="thespace.gif"> <I>object</I>] <TT>.</TT>

<P>
If two or more subjects match the activity, replace the subject in the answer
with enumeration of all such subjects, in the same order as the corresponding
statements have appeared in the input. Subjects are separated with comma and
space, last two subjects are separated with the word "<TT>and</TT>".
If "<TT>everybody</TT>" belongs to the group of enumerated subjects, do not
enumerate subjects, and print "<TT>everybody</TT>" only. If the enumeration
contains at least two subjects, the predicate matches the plural subject
(i.e. verb is without trailing "<TT>s</TT>"), otherwise it matches the only
subject.
<BR>
<I>subject1</I> <TT>,</TT>  <IMG  SRC="thespace.gif"> <I>subject2</I>  <IMG  SRC="thespace.gif"> <TT>and</TT>  <IMG  SRC="thespace.gif"> <I>subject3</I> <I>predicate</I> [ <IMG  SRC="thespace.gif"> <I>object</I>] <TT>.</TT>

<P>
If there is a&nbsp;negative statement considering the generic subject "nobody",
the specified predicate and object, the answer is:
<BR>
<I>nobody</I>  <IMG  SRC="thespace.gif"> <I>predicate</I><TT>s</TT> [ <IMG  SRC="thespace.gif"> <I>object</I>] <TT>.</TT>

<P>
Otherwise, the answer is:
<TT>I don't know.</TT>

<P>

<H3>3.&nbsp;what does subject do ?</H3>

<P>
If there are one or more sentences (both positive and negative) considering
the specified subject (or a&nbsp;generic subject "<TT>everybody</TT>" or "<TT>nobody</TT>"), all
verbs and objects from such sentences must be included in a&nbsp;reply in the same
order as the corresponding sentences have appeared in the input. No
verb-object pair can be included more than once (the eventual second
appearance must be skipped). The verb-object pairs are separated by a&nbsp;comma
followed by a&nbsp;space, the last verb is separated by a&nbsp;comma and the word
"<TT>and</TT>". Please note the comma is printed here although there was no comma
when separating the subjects in the previous type of answer (see above). The
negative answers have the same form as the statements, that means the verb
"<TT>don't</TT>" or "<TT>doesn't</TT>" is used:
<BR>
<I>subject</I> [ <IMG  SRC="thespace.gif"> <TT>don't</TT>|<TT>doesn't</TT>]  <IMG  SRC="thespace.gif"> <I>predicate1</I>[<TT>s</TT>] [ <IMG  SRC="thespace.gif"> <I>object1</I>] <TT>,</TT>
<BR>
[ <IMG  SRC="thespace.gif"> <TT>don't</TT>|<TT>doesn't</TT>]  <IMG  SRC="thespace.gif"> <I>predicate2</I>[<TT>s</TT>] [ <IMG  SRC="thespace.gif"> <I>object2</I>] <TT>,</TT>
<BR>
<IMG  SRC="thespace.gif"> <TT>and</TT> [ <IMG  SRC="thespace.gif"> <TT>don't</TT>|<TT>doesn't</TT>]  <IMG  SRC="thespace.gif"> <I>predicate3</I>[<TT>s</TT>] [ <IMG  SRC="thespace.gif"> <I>object3</I>] <TT>.</TT>
<BR>
<I>subject</I> [ <IMG  SRC="thespace.gif"> <TT>don't</TT>|<TT>doesn't</TT>]  <IMG  SRC="thespace.gif"> <I>predicate1</I>[<TT>s</TT>] [ <IMG  SRC="thespace.gif"> <I>object1</I>] <TT>,</TT>
<BR>
<IMG  SRC="thespace.gif"> <TT>and</TT> [ <IMG  SRC="thespace.gif"> <TT>don't</TT>|<TT>doesn't</TT>]  <IMG  SRC="thespace.gif"> <I>predicate2</I>[<TT>s</TT>] [ <IMG  SRC="thespace.gif"> <I>object2</I>] <TT>.</TT>
<BR>
<I>subject</I> [ <IMG  SRC="thespace.gif"> <TT>don't</TT>|<TT>doesn't</TT>]  <IMG  SRC="thespace.gif"> <I>predicate</I>[<TT>s</TT>] [ <IMG  SRC="thespace.gif"> <I>object</I>] <TT>.</TT>

<P>
Otherwise, the answer is:
<TT>I don't know.</TT>

<H3>Sample Input</H3>

<PRE>
1
I like hotdogs.
nobody likes to work.
everybody smiles.
what do I do?
who smiles?
what do you do?
does Joe smile?
do I like to work?
everybody hurts sometimes.
who walks there?
Michal walks there.
who walks there?
what does Michal do?
do you understand?
nobody walks there.
do you understand now?
bye!
</PRE>

<H3>Sample Output</H3>

<PRE>
Dialogue #1:
what do I do?
you like hotdogs, don't like to work, and smile.

who smiles?
everybody smiles.

what do you do?
I don't like to work, and smile.

does Joe smile?
yes, Joe smiles.

do I like to work?
no, you don't like to work.

who walks there?
I don't know.

who walks there?
Michal walks there.

what does Michal do?
Michal doesn't like to work, smiles, hurts sometimes, and walks there.

do you understand?
maybe.

do you understand now?
I am abroad.

bye!
</PRE>

<P><IMG SRC="../../img/line.gif" WIDTH=592 HEIGHT=32 BORDER=0>
<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->

<A NAME="ikeyb"></A><H2 ALIGN="Center">I-Keyboard</H2>
<P ALIGN="Center">(<B>file name:</B>
<CODE><A HREF="ikeyb.c">ikeyb.c</A>, <A HREF="ikeyb.p">ikeyb.p</A>, ikeyb.C</CODE>)
<BR><CODE><A HREF="ikeyb.in">ikeyb.in</A>, <A HREF="ikeyb.out">ikeyb.out</A></CODE>

<P>
Most of you have probably tried to type an&nbsp;SMS message on the keypad of
a&nbsp;cellular phone. It is sometimes very annoying to write longer messages,
because one key must be usually pressed several times to produce a&nbsp;single
letter. It is due to a&nbsp;low number of keys on the keypad. Typical phone has
twelve keys only (and maybe some other control keys that are not used for
typing). Moreover, only eight keys are used for typing 26&nbsp;letters of
an&nbsp;English alphabet. The standard assignment of letters on the keypad is
shown in the left picture:

<P>

<TABLE ALIGN=CENTER><TR><TD>

<TABLE BORDERCOLOR=BLACK CELLPADDING=3 CELLSPACING=0 BORDER="1">
<TR><TD ALIGN="CENTER">1<BR>&nbsp;</TD>
<TD ALIGN="CENTER">2<BR>abc</TD>
<TD ALIGN="CENTER">3<BR>def</TD>
</TR>
<TR><TD ALIGN="CENTER">4<BR>ghi</TD>
<TD ALIGN="CENTER">5<BR>jkl</TD>
<TD ALIGN="CENTER">6<BR>mno</TD>
</TR>
<TR><TD ALIGN="CENTER">7<BR>pqrs</TD>
<TD ALIGN="CENTER">8<BR>tuv</TD>
<TD ALIGN="CENTER">9<BR>wxyz</TD>
</TR>
<TR><TD ALIGN="CENTER">*<BR>&nbsp;</TD>
<TD ALIGN="CENTER">0<BR><EM>space</EM></TD>
<TD ALIGN="CENTER">#<BR>&nbsp;</TD>
</TR>
</TABLE>

</TD><TD>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</TD><TD>

<TABLE BORDERCOLOR=BLACK CELLPADDING=3 CELLSPACING=0 BORDER="1">
<TR><TD ALIGN="CENTER">1<BR>&nbsp;</TD>
<TD ALIGN="CENTER">2<BR>abcd</TD>
<TD ALIGN="CENTER">3<BR>efg</TD>
</TR>
<TR><TD ALIGN="CENTER">4<BR>hijk</TD>
<TD ALIGN="CENTER">5<BR>lm</TD>
<TD ALIGN="CENTER">6<BR>nopq</TD>
</TR>
<TR><TD ALIGN="CENTER">7<BR>rs</TD>
<TD ALIGN="CENTER">8<BR>tuv</TD>
<TD ALIGN="CENTER">9<BR>wxyz</TD>
</TR>
<TR><TD ALIGN="CENTER">*<BR>&nbsp;</TD>
<TD ALIGN="CENTER">0<BR><EM>space</EM></TD>
<TD ALIGN="CENTER">#<BR>&nbsp;</TD>
</TR>
</TABLE>

</TD></TR>
</TABLE>

<P>
There are 3 or 4 letters assigned to each key. If you want the first letter
of any group, you press that key once. If you want the second letter, you
have to press the key twice. For other letters, the key must be pressed three
or four times. The authors of the keyboard did not try to optimise the layout
for minimal number of keystrokes. Instead, they preferred the even
distribution of letters among the keys. Unfortunately, some letters are more
frequent than others. Some of these frequent letters are placed on the third
or even fourth place on the standard keyboard. For
example, <TT>S</TT> is a&nbsp;very common letter in an&nbsp;English alphabet, and we need
four keystrokes to type it. If the assignment of characters was like in the
right picture, the keyboard would be much more comfortable for typing average
English texts.

<P>
ACM have decided to put an&nbsp;optimised version of the keyboard on its new
cellular phone. Now they need a&nbsp;computer program that will find an&nbsp;optimal
layout for the given letter frequency. We need to preserve alphabetical
order of letters, because the user would be confused if the letters were
mixed. But we can assign any number of letters to a&nbsp;single key.

<P>
<H3>Input Specification</H3>

<P>
There is a&nbsp;single positive integer <VAR>T</VAR> on the first line of input. It stands
for the number of test cases to follow. Each test case begins with a&nbsp;line
containing two integers <VAR>K</VAR>, <VAR>L</VAR> (1  &lt;= <VAR>K</VAR>  &lt;= <VAR>L</VAR>  &lt;= 90) separated by
a&nbsp;single space. <VAR>K</VAR> is the number of keys, <VAR>L</VAR> is the number of letters to be
mapped onto those keys. Then there are two lines. The first
one contains exactly <VAR>K</VAR> characters each representing a&nbsp;name of one
key. The second line contains exactly <VAR>L</VAR> characters representing names
of letters of an&nbsp;alphabet. Keys and letters are represented by digits,
letters (which are case-sensitive), or any punctuation characters (ASCII code
between 33 and 126 inclusively). No two keys have the same character, no two
letters are the same. However, the name of a&nbsp;letter can be used also as
a&nbsp;name for a&nbsp;key.

<P>
After those two lines, there are exactly <VAR>L</VAR> lines each containing exactly
one positive integer <VAR>F</VAR><SUB>1</SUB>, <VAR>F</VAR><SUB>2</SUB>, ... <VAR>F</VAR><SUB><VAR>L</VAR></SUB>. These numbers determine the
frequency of every letter, starting with the first one and continuing with
the others sequentially. The higher number means the more common letter. No
frequency will be higher than 100000.

<P>
<H3>Output Specification</H3>

<P>
Find an&nbsp;optimal keyboard for each test case. Optimal keyboard is such that
has the lowest "price" for typing average text. The <EM>price</EM> is determined
as the sum of the prices of each letter. The price of a&nbsp;letter is a&nbsp;product
of the&nbsp;letter frequency (<VAR>F</VAR><SUB><VAR>i</VAR></SUB>) and its position on the key. The order of
letters cannot be changed, they must be grouped in the given order.

<P>
If there are more solutions with the same price, we will try to maximise the
number of letters assigned to the last key, then to the one before the last
one etc.

<P>
More formally, you are to find a&nbsp;sequence <VAR>P</VAR><SUB>1</SUB>, <VAR>P</VAR><SUB>2</SUB>, ... <VAR>P</VAR><SUB><VAR>L</VAR></SUB> 
representing the position of every letter on a&nbsp;particular key. The sequence
must meet following conditions:
<UL>
<LI><VAR>P</VAR><SUB>1</SUB> = 1
<LI>for each <VAR>i</VAR>&gt;1, either 
<VAR>P</VAR><SUB><VAR>i</VAR></SUB> = <VAR>P</VAR><SUB><VAR>i</VAR>-1</SUB>+1 or <VAR>P</VAR><SUB><VAR>i</VAR></SUB> = 1
<LI>there are at most <VAR>K</VAR> numbers <VAR>P</VAR><SUB><VAR>i</VAR></SUB> such that <VAR>P</VAR><SUB><VAR>i</VAR></SUB> = 1
<LI>the sum of products <VAR>S</VAR><SUB><VAR>P</VAR></SUB> = 
<IMG
 WIDTH="32" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
 SRC="img7.gif"
 >
<VAR>F</VAR><SUB><VAR>i</VAR></SUB>.<VAR>P</VAR><SUB><VAR>i</VAR></SUB> is minimal
<LI>for any other sequence <VAR>Q</VAR> meeting these criteria and with the same
  sum <VAR>S</VAR><SUB><VAR>Q</VAR></SUB> = <VAR>S</VAR><SUB><VAR>P</VAR></SUB>, there exists such <VAR>M</VAR>, 
1 &lt;= <VAR>M</VAR> &lt;= <VAR>L</VAR> that for any <VAR>J</VAR>,
  <VAR>M</VAR>&lt;<VAR>J</VAR> &lt;= <VAR>L</VAR>, <VAR>P</VAR><SUB><VAR>J</VAR></SUB> = <VAR>Q</VAR><SUB><VAR>J</VAR></SUB>, and <VAR>P</VAR><SUB><VAR>M</VAR></SUB>&gt;<VAR>Q</VAR><SUB><VAR>M</VAR></SUB>.
</UL>
<P>
The output for every test case must start with a&nbsp;single line saying
<TT>Keypad #</TT><VAR>I</VAR><TT>:</TT>, where <VAR>I</VAR> is a&nbsp;sequential order of the test case,
starting with 1. Then there must be exactly <VAR>K</VAR> lines, each representing one
letter, in the same order that was used in input. Each line must contain the
character representing the key, a&nbsp;colon, one space and a&nbsp;list of letters
assigned to that particular key. Letters are not separated from each other.

<P>
Print one blank line after each test case, including the last one.

<H3>Sample Input</H3>

<PRE>
1
8 26
23456789
ABCDEFGHIJKLMNOPQRSTUVWXYZ
3371
589
1575
1614
6212
971
773
1904
2989
123
209
1588
1513
2996
3269
1080
121
2726
3083
4368
1334
518
752
427
733
871
</PRE>

<H3>Sample Output</H3>

<PRE>
Keypad #1:
2: ABCD
3: EFG
4: HIJK
5: LM
6: NOPQ
7: RS
8: TUV
9: WXYZ
</PRE>

<!-- ***** konec stranky (s pocitadlem pristupu) ***** -->

<P><IMG SRC="../../img/line.gif" WIDTH=592 HEIGHT=32 BORDER=0>

<P><TABLE BORDER=0>
<TR><TD>You are visitor number
<TD><IMG SRC="http://hpk.felk.cvut.cz/cgi-bin/contest/counter.cgi?00cerc"
WIDTH=128 HEIGHT=48>
<TD>since September 25th, 2000.
</TABLE>
</TABLE>

</BODY>
</HTML>
